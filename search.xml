<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>èƒŒåŒ…é—®é¢˜</title>
    <url>/2019/11/29/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>å¾…è¡¥å……</p>
<h2 id="0-1èƒŒåŒ…é—®é¢˜"><a href="#0-1èƒŒåŒ…é—®é¢˜" class="headerlink" title="0/1èƒŒåŒ…é—®é¢˜"></a>0/1èƒŒåŒ…é—®é¢˜</h2><h3 id="äºŒç»´åŠ¨æ€è§„åˆ’"><a href="#äºŒç»´åŠ¨æ€è§„åˆ’" class="headerlink" title="äºŒç»´åŠ¨æ€è§„åˆ’"></a>äºŒç»´åŠ¨æ€è§„åˆ’</h3><p>æœ‰ä¸€ä¸ªå®¹é‡ä¸º N çš„èƒŒåŒ…ï¼Œè¦ç”¨è¿™ä¸ªèƒŒåŒ…è£…ä¸‹ç‰©å“çš„ä»·å€¼æœ€å¤§ï¼Œè¿™äº›ç‰©å“æœ‰ä¸¤ä¸ªå±æ€§ï¼šä½“ç§¯ w å’Œä»·å€¼ vã€‚</p>
<p>å®šä¹‰ä¸€ä¸ªäºŒç»´æ•°ç»„ <code>dp</code> å­˜å‚¨æœ€å¤§ä»·å€¼ï¼Œå…¶ä¸­ <code>dp[i][j]</code> è¡¨ç¤ºå‰ i ä»¶ç‰©å“ä½“ç§¯ä¸è¶…è¿‡ j çš„æƒ…å†µä¸‹èƒ½è¾¾åˆ°çš„æœ€å¤§ä»·å€¼ã€‚è®¾ç¬¬ i ä»¶ç‰©å“ä½“ç§¯ä¸º wï¼Œä»·å€¼ä¸º vï¼Œæ ¹æ®ç¬¬ i ä»¶ç‰©å“æ˜¯å¦æ·»åŠ åˆ°èƒŒåŒ…ä¸­ï¼Œå¯ä»¥åˆ†ä¸¤ç§æƒ…å†µè®¨è®ºï¼š</p>
<ul>
<li>ç¬¬ i ä»¶ç‰©å“æ²¡æ·»åŠ åˆ°èƒŒåŒ…ï¼Œæ€»ä½“ç§¯ä¸è¶…è¿‡ j çš„å‰ i ä»¶ç‰©å“çš„æœ€å¤§ä»·å€¼å°±æ˜¯æ€»ä½“ç§¯ä¸è¶…è¿‡ j çš„å‰ i-1 ä»¶ç‰©å“çš„æœ€å¤§ä»·å€¼ï¼Œ<code>dp[i][j] = dp[i-1][j]</code>ã€‚</li>
<li>ç¬¬ i ä»¶ç‰©å“æ·»åŠ åˆ°èƒŒåŒ…ä¸­ï¼Œ<code>dp[i][j] = dp[i-1][j-w] + v</code>ã€‚</li>
</ul>
<p>ç¬¬ i ä»¶ç‰©å“å¯æ·»åŠ ä¹Ÿå¯ä»¥ä¸æ·»åŠ ï¼Œå–å†³äºå“ªç§æƒ…å†µä¸‹æœ€å¤§ä»·å€¼æ›´å¤§ã€‚å› æ­¤ï¼Œ0-1 èƒŒåŒ…çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¸ºï¼š</p>
<script type="math/tex; mode=display">
dp[i][j] = max(dp[i-1][j],dp[i-1][j-w]+v)</script><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>{</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        W è¡¨ç¤ºèƒŒåŒ…èƒ½å®¹çº³çš„æœ€å¤§é‡é‡</span></span><br><span class="line"><span class="comment">        N è¡¨ç¤ºç‰©å“çš„æ•°é‡</span></span><br><span class="line"><span class="comment">        wiehgts è¡¨ç¤º N ä»¶ç‰©å“çš„é‡é‡</span></span><br><span class="line"><span class="comment">        value è¡¨ç¤º N ä»¶ç‰©å“çš„ä»·å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">knapsack</span><span class="params">(<span class="keyword">int</span> W, <span class="keyword">int</span> N, <span class="keyword">int</span>[] weights, <span class="keyword">int</span>[] values)</span> </span>{</span><br><span class="line">        <span class="comment">//dp[i][j] è¡¨ç¤ºåªæ”¾å‰ i ä»¶çš„å•†å“ï¼Œä½“ç§¯ä¸è¶…è¿‡ j çš„æœ€å¤§ä»·å€¼</span></span><br><span class="line">        <span class="keyword">int</span>[][] dp = <span class="keyword">new</span> <span class="keyword">int</span>[N + <span class="number">1</span>][W + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i <= N; i++) {</span><br><span class="line">            <span class="keyword">int</span> w = weights[i - <span class="number">1</span>];</span><br><span class="line">            <span class="keyword">int</span> v = values[i - <span class="number">1</span>];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j <= w; j++) {</span><br><span class="line">                <span class="keyword">if</span> (j >= w) {</span><br><span class="line">                    dp[i][j] = Math.max(dp[i - <span class="number">1</span>][j], dp[i - <span class="number">1</span>][j - w] + v);</span><br><span class="line">                } <span class="keyword">else</span> {</span><br><span class="line">                    dp[i][j] = dp[i - <span class="number">1</span>][j];</span><br><span class="line">                }</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> dp[N][W];</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p><strong>æˆ‘ä»¬ä»¥ä¸‹é¢çš„ç‰©å“ä¸¾ä¾‹è¯´æ˜æ±‚è§£çš„è¿‡ç¨‹</strong></p>
<div align="left"> <img src="https://github.com/IBITM/ibitm.github.io/blob/master/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E8%A1%A8%E5%8D%952.png?raw=true" width="274px" height="141px"> </div>
ä¸‹é¢ä»¥å››ä¸ªçŠ¶æ€çš„è®¡ç®—ä¸¾ä¾‹

<div align="left"> <img src="https://github.com/IBITM/ibitm.github.io/blob/master/img/%E6%9C%AA%E5%91%BD%E5%90%8D%E8%A1%A8%E5%8D%95.png?raw=true" width="1108px" height="535px"> </div>

<h3 id="ä¸€ç»´åŠ¨æ€è§„åˆ’"><a href="#ä¸€ç»´åŠ¨æ€è§„åˆ’" class="headerlink" title="ä¸€ç»´åŠ¨æ€è§„åˆ’"></a>ä¸€ç»´åŠ¨æ€è§„åˆ’</h3><p>è§‚å¯ŸçŠ¶æ€è½¬ç§»æ–¹ç¨‹æˆ–è€…å¡«å……è¡¨æ ¼çš„é¡ºåºï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå‰ i ä»¶ç‰©å“çš„çŠ¶æ€ä»…ä¸å‰ i-1 ä»¶ç‰©å“çš„çŠ¶æ€æœ‰å…³ï¼Œå› æ­¤å¯ä»¥å°† dp å®šä¹‰ä¸ºä¸€ç»´æ•°ç»„ï¼Œå…¶ä¸­<code>dp[j]</code>  æ—¢å¯ä»¥è¡¨ç¤º <code>dp[i-1][j]</code> ä¹Ÿå¯ä»¥è¡¨ç¤º <code>dp[i][j]</code>ï¼Œæœ¬è´¨ä¸Šè¡¨ç¤ºå®¹é‡ä¸º j æ—¶ï¼Œå¯ä»¥è·å¾—çš„æœ€å¤§ä»·å€¼ã€‚</p>
<script type="math/tex; mode=display">
dp[j] = max(dp[j],dp[j-w]+v)</script><p>å¦‚æœæˆ‘ä»¬å®ç°ä»£ç çš„æ—¶å€™ï¼Œå†…å±‚å¾ªç¯è¿˜æ˜¯æŒ‰ç…§ä»å°åˆ°å¤§å¾ªç¯çš„è¯ï¼Œå°±ä¼šå‡ºç°ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯<code>dp[j-w]</code>è¡¨ç¤ºçš„ä¸å†æ˜¯<code>dp[i-1][j-w]</code>è€Œæ˜¯<code>dp[i][j-w]</code>ã€‚</p>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å®ç°çš„æ—¶å€™å†…å±‚å¾ªç¯ï¼Œè¦ä»å¤§å‘å°æ¥å¾ªç¯ã€‚</p>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">knapsack</span><span class="params">(<span class="keyword">int</span> W, <span class="keyword">int</span> N, <span class="keyword">int</span>[] weights, <span class="keyword">int</span>[] values)</span> </span>{</span><br><span class="line">    <span class="keyword">int</span>[] dp = <span class="keyword">new</span> <span class="keyword">int</span>[W + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i <= N; i++) {</span><br><span class="line">        <span class="keyword">int</span> w = weights[i - <span class="number">1</span>], v = values[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = W; j >= <span class="number">1</span>; j--) {</span><br><span class="line">            <span class="keyword">if</span> (j >= w) {</span><br><span class="line">                dp[j] = Math.max(dp[j], dp[j - w] + v);</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> dp[W];</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>ä»ä¸Šé¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºä»äºŒç»´å‹ç¼©æˆä¸€ç»´ï¼Œä¸¢å¤±äº†ç‰©å“æ·»åŠ é¡ºåºä¿¡æ¯ï¼Œè¿™ä¸€ç‚¹æ˜¯æˆ‘ä»¬éœ€è¦æ³¨æ„çš„ã€‚</p>
<p>å†…å®¹å‚è€ƒ<a href="https://cyc2018.github.io/CS-Notes/#/notes/Leetcode%20%E9%A2%98%E8%A7%A3%20-%20%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92?id=_0-1-%e8%83%8c%e5%8c%85" target="_blank" rel="noopener">Leetcodeé¢˜è§£/åŠ¨æ€è§„åˆ’/0-1-èƒŒåŒ…</a></p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>]]></content>
      <categories>
        <category>æ•°æ®ç»“æ„å’Œç®—æ³•</category>
      </categories>
      <tags>
        <tag>èƒŒåŒ…é—®é¢˜</tag>
        <tag>æ•°æ®ç»“æ„å’Œç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title>aaa</title>
    <url>/2019/11/27/aaa/</url>
    <content><![CDATA[<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>]]></content>
  </entry>
  <entry>
    <title>646. æœ€é•¿æ•°å¯¹é“¾</title>
    <url>/2019/11/27/646-%E6%9C%80%E9%95%BF%E6%95%B0%E5%AF%B9%E9%93%BE/</url>
    <content><![CDATA[<h4 id="646-æœ€é•¿æ•°å¯¹é“¾"><a href="#646-æœ€é•¿æ•°å¯¹é“¾" class="headerlink" title="646. æœ€é•¿æ•°å¯¹é“¾"></a><a href="https://leetcode-cn.com/problems/maximum-length-of-pair-chain/" target="_blank" rel="noopener">646. æœ€é•¿æ•°å¯¹é“¾</a></h4><p>å¦‚ä½•æ’åˆ— pair ä½¿å¾— pair é“¾æœ€é•¿ï¼Œç±»ä¼¼äºğŸ‘‰<a href="https://zh.wikipedia.org/wiki/%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95" target="_blank" rel="noopener">è´ªå¿ƒç®—æ³•</a>çš„ç»å…¸é—®é¢˜-âœï¸<a href="https://en.wikipedia.org/wiki/Activity_selection_problem" target="_blank" rel="noopener">æ´»åŠ¨é€‰æ‹©é—®é¢˜</a></p>
<p>è¿™ç±»é—®é¢˜çš„è´ªå¿ƒç®—æ³•å°±æ˜¯ï¼š</p>
<p>åœ¨ç°æœ‰çš„æ´»åŠ¨ä¸­é€‰æ‹©ã€Œæœ€æ—©ç»“æŸã€çš„æ´»åŠ¨ï¼Œå¯¹åº”åˆ°æˆ‘ä»¬çš„è¿™ä¸ªé—®é¢˜ï¼Œå°±æ˜¯é€‰æ‹© pair ä¸­ç¬¬äºŒä½æœ€å°çš„æ•°ã€‚</p>
<a id="more"></a>
<figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.Comparator;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">findLongestChain</span><span class="params">(<span class="keyword">int</span>[][] pairs)</span> </span>{</span><br><span class="line">        <span class="keyword">if</span> (pairs == <span class="keyword">null</span> || pairs.length == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> n = pairs.length;</span><br><span class="line">        Arrays.sort(pairs, <span class="keyword">new</span> Comparator<<span class="keyword">int</span>[]>() {</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(<span class="keyword">int</span>[] o1, <span class="keyword">int</span>[] o2)</span> </span>{</span><br><span class="line">                <span class="keyword">if</span> (o1[<span class="number">0</span>] != o2[<span class="number">0</span>]) {</span><br><span class="line">                    <span class="keyword">return</span> o1[<span class="number">0</span>] - o2[<span class="number">0</span>];</span><br><span class="line">                }</span><br><span class="line">                <span class="keyword">return</span> o1[<span class="number">1</span>] - o2[<span class="number">1</span>];</span><br><span class="line">            }</span><br><span class="line">        });</span><br><span class="line">        <span class="keyword">int</span> a = Integer.MIN_VALUE;</span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span>[] pair : pairs) {</span><br><span class="line">            <span class="keyword">if</span> (pair[<span class="number">0</span>] > a) {</span><br><span class="line">                a = pair[<span class="number">1</span>];</span><br><span class="line">                cnt++;</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">return</span> cnt;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>]]></content>
      <categories>
        <category>ç®—æ³•å’Œæ•°æ®ç»“æ„</category>
      </categories>
      <tags>
        <tag>Leetcode</tag>
        <tag>ç®—æ³•å’Œæ•°æ®ç»“æ„</tag>
      </tags>
  </entry>
  <entry>
    <title>Leetcode é¢˜è§£</title>
    <url>/2019/11/26/Leetcode-%E9%A2%98%E8%A7%A3/</url>
    <content><![CDATA[<p><span class="github-emoji" style="color: transparent;background:no-repeat url(https://github.githubassets.com/images/icons/emoji/unicode/1f389.png?v8) center/contain" data-src="https://github.githubassets.com/images/icons/emoji/unicode/1f389.png?v8">ğŸ‰</span> still works.</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>]]></content>
  </entry>
  <entry>
    <title>äºŒåˆ†æŸ¥æ‰¾çš„å„ç§å˜å½¢</title>
    <url>/2019/11/26/%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE%E7%9A%84%E5%90%84%E7%A7%8D%E5%8F%98%E5%BD%A2/</url>
    <content><![CDATA[<h2 id="äºŒåˆ†æŸ¥æ‰¾ï¼Œå¯»æ‰¾æ’å…¥çš„ä½ç½®"><a href="#äºŒåˆ†æŸ¥æ‰¾ï¼Œå¯»æ‰¾æ’å…¥çš„ä½ç½®" class="headerlink" title="äºŒåˆ†æŸ¥æ‰¾ï¼Œå¯»æ‰¾æ’å…¥çš„ä½ç½®"></a>äºŒåˆ†æŸ¥æ‰¾ï¼Œå¯»æ‰¾æ’å…¥çš„ä½ç½®</h2><figure class="highlight java"><table><tbody><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">binarySearch</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> l, <span class="keyword">int</span> h, <span class="keyword">int</span> k)</span> </span>{</span><br><span class="line">    <span class="comment">//å¼€åŒºé—´</span></span><br><span class="line">    <span class="keyword">while</span> (l < h) {</span><br><span class="line">        <span class="keyword">int</span> m = l + (h - l) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (nums[m] == k) {</span><br><span class="line">            <span class="keyword">return</span> m;</span><br><span class="line">        } <span class="keyword">else</span> <span class="keyword">if</span> (nums[m] > k) {</span><br><span class="line">            h = m;</span><br><span class="line">        } <span class="keyword">else</span></span><br><span class="line">            l = m + <span class="number">1</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> l;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>]]></content>
      <tags>
        <tag>ç®—æ³•å’Œæ•°æ®ç»“æ„</tag>
      </tags>
  </entry>
  <entry>
    <title>Scalaå’ŒJavaçš„ç‰ˆæœ¬å…¼å®¹é—®é¢˜</title>
    <url>/2019/11/26/Scala-and-java-version-compatibility-issues/</url>
    <content><![CDATA[<p><img src="https://github.com/IBITM/ibitm.github.io/blob/master/img/1574740536160.png?raw=true" alt></p>
<p><a href="https://docs.scala-lang.org/overviews/jdk-compatibility/overview.html" target="_blank" rel="noopener">JDK COMPATIBILITY</a></p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>]]></content>
      <tags>
        <tag>scala</tag>
      </tags>
  </entry>
  <entry>
    <title>Spark å…±äº«å˜é‡çš„è‹¥å¹²æ€è€ƒ</title>
    <url>/2019/11/26/reflections-on-Spark-shared-variables/</url>
    <content><![CDATA[<p>é€šå¸¸åœ¨å‘ Spark ä¼ é€’å‡½æ•°æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ driver programme ä¸­å®šä¹‰çš„å˜é‡ï¼Œä½†æ˜¯é›†ç¾¤ä¸­è¿è¡Œçš„æ¯ä¸ª tusk éƒ½åªä¼šå¾—åˆ°è¿™äº›å˜é‡çš„ä¸€ä»½æ–°çš„å‰¯æœ¬ï¼Œæ›´æ–°è¿™äº›å‰¯æœ¬çš„å€¼ä¹Ÿä¸ä¼šå½±å“driver programme ä¸­çš„å¯¹åº”å˜é‡ã€‚</p>
<p>Spark çš„ä¸¤ä¸ªå…±äº«å˜é‡ï¼Œç´¯åŠ å™¨ä¸å¹¿æ’­å˜é‡ï¼Œä½¿ç”¨ç»“æœèšåˆä¸å¹¿æ’­è¿™ä¸¤ç§å¸¸è§çš„é€šä¿¡æ¨¡å¼çªç ´äº†è¿™ä¸€é™åˆ¶ã€‚<br><a id="more"></a></p>
<h2 id="Accumulator"><a href="#Accumulator" class="headerlink" title="Accumulator"></a>Accumulator</h2><h3 id="åŸºæœ¬ä½¿ç”¨æ–¹æ³•"><a href="#åŸºæœ¬ä½¿ç”¨æ–¹æ³•" class="headerlink" title="åŸºæœ¬ä½¿ç”¨æ–¹æ³•"></a>åŸºæœ¬ä½¿ç”¨æ–¹æ³•</h3><p>ç¬¬ä¸€ç§å…±äº«å˜é‡ï¼Œå³ç´¯åŠ å™¨ï¼Œæä¾›äº†å°† worker node ä¸­çš„å€¼èšåˆåˆ° driver programme ä¸­çš„ç®€å•è¯­æ³•ã€‚</p>
<p>ä¸‹é¢çš„ä»£ç å±•ç¤ºäº†ä¸€ä¸ª accumulator è¢«ç”¨äºå¯¹ä¸€ä¸ªæ•°ç»„ä¸­çš„å…ƒç´ æ±‚å’Œ:</p>
<figure class="highlight scala"><table><tbody><tr><td class="code"><pre><span class="line">scala> <span class="keyword">val</span> accum = sc.longAccumulator(<span class="string">"My Accumulator"</span>)</span><br><span class="line">accum: org.apache.spark.util.<span class="type">LongAccumulator</span> = <span class="type">LongAccumulator</span>(id: <span class="number">0</span>, name: <span class="type">Some</span>(<span class="type">My</span> <span class="type">Accumulator</span>), value: <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">scala> sc.parallelize(<span class="type">Array</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)).foreach(x => accum.add(x))</span><br><span class="line">...</span><br><span class="line"><span class="number">10</span>/<span class="number">09</span>/<span class="number">29</span> <span class="number">18</span>:<span class="number">41</span>:<span class="number">08</span> <span class="type">INFO</span> <span class="type">SparkContext</span>: <span class="type">Tasks</span> finished in <span class="number">0.317106</span> s</span><br><span class="line"></span><br><span class="line">scala> accum.value</span><br><span class="line">res2: <span class="type">Long</span> = <span class="number">10</span></span><br></pre></td></tr></tbody></table></figure>
<p>å¯ä»¥é€šè¿‡è°ƒç”¨ <code>SparkContext.longAccumulator()</code> æˆ– <code>SparkContext.doubleAccumulator()</code> æ–¹æ³•åˆ›å»ºæ•°å€¼ç±»å‹çš„ <code>accumulator</code>ï¼ˆç´¯åŠ å™¨ï¼‰ä»¥åˆ†åˆ«ç´¯åŠ  Long æˆ– Double ç±»å‹çš„å€¼ã€‚é›†ç¾¤ä¸Šæ­£åœ¨è¿è¡Œçš„ä»»åŠ¡å°±å¯ä»¥ä½¿ç”¨ <code>add</code> æ–¹æ³•æ¥ç´¯è®¡æ•°å€¼ã€‚</p>
<p>æ³¨æ„ï¼Œworker node ä¸Šçš„ tusk ä¸èƒ½è®¿é—®ç´¯åŠ å™¨çš„å€¼ã€‚ä»è¿™äº›ä»»åŠ¡çš„è§’åº¦æ¥çœ‹ï¼Œç´¯åŠ å™¨æ˜¯ä¸€ä¸ªåªå†™å˜é‡ã€‚åªæœ‰ driver program æ‰å¯ä»¥ä½¿ç”¨ <code>value</code> æ–¹æ³•è¯»å–ç´¯åŠ å™¨çš„å€¼ã€‚</p>
<h3 id="ç´¯åŠ å™¨ä¸å®¹é”™"><a href="#ç´¯åŠ å™¨ä¸å®¹é”™" class="headerlink" title="ç´¯åŠ å™¨ä¸å®¹é”™"></a>ç´¯åŠ å™¨ä¸å®¹é”™</h3><p>Spark ä¼šè‡ªåŠ¨é‡æ–°æ‰§è¡Œå¤±è´¥çš„æˆ–è¾ƒæ…¢çš„ä»•åŠ¡æ¥åº”å¯¹æœ‰é”™çš„æˆ–ç€æ¯”è¾ƒæ…¢çš„æœºå™¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå¯¹æŸåˆ†åŒºæ‰§è¡Œ <code>map()</code> æ“ä½œçš„èŠ‚ç‚¹å¤±è´¥äº†ï¼ŒSpark ä¼šåœ¨å¦ä¸€ä¸ªèŠ‚ç‚¹ä¸Šé‡æ–°è¿è¡Œè¯¥ä»»åŠ¡ã€‚å³ä½¿è¯¥èŠ‚ç‚¹æ²¡æœ‰å´©æºƒï¼Œè€Œåªæ˜¯å¤„ç†é€Ÿåº¦æ¯”åˆ«çš„èŠ‚ç‚¹æ…¢å¾ˆå¤šï¼ŒSpark ä¹Ÿå¯ä»¥æŠ¢å å¼åœ°åœ¨å¦ä¸€ä¸ªèŠ‚ç‚¹ä¸Šå¯åŠ¨ä¸€ä¸ªâ€œæŠ•æœºâ€ï¼ˆspeculativeï¼‰å‹çš„ä»»åŠ¡å‰¯æœ¬ï¼Œå¦‚æœè¯¥ä»»åŠ¡æ›´æ—©ç»“æŸå°±å¯ä»¥ç›´æ¥è·å–ç»“æœã€‚å³ä½¿æ²¡æœ‰èŠ‚ç‚¹å¤±è´¥ï¼ŒSparkæœ‰æ—¶ä¹Ÿéœ€è¦é‡æ–°è¿è¡Œä»»åŠ¡æ¥è·å–ç¼“å­˜ä¸­è¢«ç§»é™¤å‡ºå†…å­˜çš„æ•°æ®ã€‚</p>
<p><em>å› æ­¤æœ€ç»ˆç»“æœå°±æ˜¯åŒä¸€ä¸ªå‡½æ•°å¯èƒ½å¯¹åŒä¸€ä¸ªæ•°æ®è¿è¡Œäº†å¤šæ¬¡ã€‚</em></p>
<p>è¿™ç§æƒ…å†µä¸‹ç´¯åŠ å™¨è¦æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ</p>
<p>å®é™…ç»“æœæ˜¯ï¼Œå¯¹äºè¦åœ¨ action æ“ä½œä¸­ä½¿ç”¨çš„ç´¯åŠ å™¨ï¼ŒSparkåªä¼šæŠŠæ¯ä¸ªä»»åŠ¡å¯¹ç´¯åŠ å™¨çš„ä¿®æ”¹åº”ç”¨ä¸€æ¬¡ã€‚</p>
<p>å› æ­¤ï¼Œå¦‚æœæƒ³è¦ä¸€ä¸ªæ— è®ºåœ¨å¤±è´¥è¿˜æ˜¯é‡å¤è®¡ç®—æ—¶éƒ½ç»å¯¹å¯é çš„ç´¯åŠ å™¨ï¼Œæˆ‘ä»¬å¿…é¡»æŠŠå®ƒæ”¾åœ¨ <code>foreach()</code> è¿™æ ·çš„ action æ“ä½œä¸­ã€‚å¯¹äºåœ¨ RDD  transform æ“ä½œä¸­ä½¿ç”¨çš„ç´¯åŠ å™¨ï¼Œå°±ä¸èƒ½ä¿è¯æœ‰è¿™ç§æƒ…å†µäº†ã€‚transform æ“ä½œä¸­ç´¯åŠ å™¨å¯èƒ½ä¼šå‘ç”Ÿä¸æ­¢ä¸€æ¬¡æ›´æ–°ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œå½“ä¸€ä¸ªè¢«ç¼“å­˜ä¸‹æ¥ä½†æ˜¯æ²¡æœ‰ç»å¸¸ä½¿ç”¨çš„RDDåœ¨ç¬¬ä¸€æ¬¡ä» LRU ç¼“å­˜ä¸­è¢«ç§»é™¤å¹¶åˆè¢«é‡æ–°ç”¨åˆ°æ—¶ï¼Œè¿™ç§éé¢„æœŸçš„ç´¯åŠ å™¨çš„å¤šæ¬¡æ›´æ–°å°±ä¼šå‘ç”Ÿã€‚</p>
<h2 id="Broadcast-Variables"><a href="#Broadcast-Variables" class="headerlink" title="Broadcast Variables"></a>Broadcast Variables</h2><p>Spark çš„ç¬¬äºŒç§å…±äº«å˜é‡æ˜¯<em>å¹¿æ’­å˜é‡</em>ï¼Œå®ƒå¯ä»¥è®©ç¨‹åºé«˜æ•ˆçš„å‘æ‰€æœ‰çš„ worker node å‘é€ä¸€ä¸ªè¾ƒå¤§çš„ åªè¯»å€¼ã€‚æ¯”å¦‚ï¼Œä½ çš„åº”ç”¨éœ€è¦å‘æ‰€æœ‰çš„èŠ‚ç‚¹å‘é€ä¸€ä¸ªè¾ƒå¤§çš„åªè¯»æŸ¥è¯¢è¡¨ï¼Œç”šè‡³æ˜¯æœºå™¨å­¦ä¹ ç®—æ³•ä¸­çš„ä¸€ä¸ªå¾ˆå¤§çš„ç‰¹å¾å‘é‡ï¼Œè¿™ä¸ªæ—¶å€™å¹¿æ’­å˜é‡å°±ä¼šå¾ˆå¥½ç”¨äº†ã€‚</p>
<p>å¦‚æœä½ å¯¹é—­åŒ…æœ‰äº†è§£ï¼Œä½ ä¼šå‘ç°ï¼ŒSpark ä¼šè‡ªåŠ¨æŠŠé—­åŒ…ä¸­æ‰€æœ‰å¼•ç”¨åˆ°çš„å˜é‡å‘é€åˆ° worker nodeä¸Šã€‚è¿™è™½ç„¶å¾ˆæ–¹ä¾¿ï¼Œä½†ä¹Ÿå¾ˆä½æ•ˆã€‚åŸå› æœ‰äºŒï¼š</p>
<ul>
<li>é»˜è®¤çš„ä»»åŠ¡å‘é€æœºåˆ¶æ˜¯ä¸“é—¨ä¸ºå°ä»»åŠ¡è¿›è¡Œä¼˜åŒ–çš„ï¼Œå½“å‘é€çš„å…±äº«æ•°æ®é‡è¾ƒå¤§æ—¶æ•ˆç‡è¾ƒä½</li>
<li>äº‹å®ä¸Šä½ å¯èƒ½ä¼šåœ¨å¤šä¸ªæ“ä½œä¸­ä½¿ç”¨åŒä¸€ä¸ªå˜é‡ï¼Œä½†æ˜¯Sparkä¼šä¸ºæ¯ä¸ªæ“ä½œåˆ†åˆ«å‘é€ã€‚</li>
</ul>
<p>å¹¿æ’­å˜é‡é€šè¿‡åœ¨ä¸€ä¸ªå˜é‡ <code>v</code> ä¸Šè°ƒç”¨ <code>SparkContext.broadcast(v)</code> æ–¹æ³•æ¥è¿›è¡Œåˆ›å»ºã€‚å¹¿æ’­å˜é‡æ˜¯ <code>v</code> çš„ä¸€ä¸ª wrapperï¼ˆåŒ…è£…å™¨ï¼‰ï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨ <code>value</code> æ–¹æ³•æ¥è®¿é—®å®ƒçš„å€¼ã€‚ä»£ç ç¤ºä¾‹å¦‚ä¸‹:</p>
<figure class="highlight scala"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">// è¿™é‡Œçš„ v æŒ‡çš„æ˜¯ Array(1, 2, 3)</span></span><br><span class="line">scala> <span class="keyword">val</span> broadcastVar = sc.broadcast(<span class="type">Array</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>))</span><br><span class="line">broadcastVar: org.apache.spark.broadcast.<span class="type">Broadcast</span>[<span class="type">Array</span>[<span class="type">Int</span>]] = <span class="type">Broadcast</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">scala> broadcastVar.value</span><br><span class="line">res0: <span class="type">Array</span>[<span class="type">Int</span>] = <span class="type">Array</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br></pre></td></tr></tbody></table></figure><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>]]></content>
      <tags>
        <tag>spark</tag>
      </tags>
  </entry>
  <entry>
    <title>Windowsä¸‹çš„Sparkç¨‹åºå¼€å‘ç¯å¢ƒé…ç½®</title>
    <url>/2019/11/25/Spark-program-development-environment-configuration-under-Windows/</url>
    <content><![CDATA[<p>åœ¨Windowsç¯å¢ƒä¸‹, ä½¿ç”¨IDEAè¿›è¡ŒSparkç¨‹åºå¼€å‘æ‰€éœ€çš„ç¯å¢ƒé…ç½®, ä¸»è¦æ˜¯Maven pomæ–‡ä»¶çš„é…ç½®å’ŒScala SDKçš„é…ç½®ã€‚<br><a id="more"></a></p>
<h3 id="Mavençš„å®‰è£…ä¸é…ç½®"><a href="#Mavençš„å®‰è£…ä¸é…ç½®" class="headerlink" title="Mavençš„å®‰è£…ä¸é…ç½®"></a>Mavençš„å®‰è£…ä¸é…ç½®</h3><p>éœ€è¦é…ç½®<code>Maven home directory</code>ã€<code>User settings file</code>ã€<code>Local repository</code>ã€ <code>Import Maven projects automatically</code></p>
<h2 id="IDEA-Mavenå·¥ç¨‹åˆ›å»ºä¸é…ç½®"><a href="#IDEA-Mavenå·¥ç¨‹åˆ›å»ºä¸é…ç½®" class="headerlink" title="IDEA Mavenå·¥ç¨‹åˆ›å»ºä¸é…ç½®"></a>IDEA Mavenå·¥ç¨‹åˆ›å»ºä¸é…ç½®</h2><h3 id="é…ç½®pom-xmlæ–‡ä»¶"><a href="#é…ç½®pom-xmlæ–‡ä»¶" class="headerlink" title="é…ç½®pom.xmlæ–‡ä»¶"></a>é…ç½®<code>pom.xml</code>æ–‡ä»¶</h3><p><strong>sparkç²¾ç®€ç‰ˆçš„pom.xml</strong></p>
<p><a href="https://github.com/apache/spark/blob/master/examples/pom.xml" target="_blank" rel="noopener">https://github.com/apache/spark/blob/master/examples/pom.xml</a></p>
<p><strong>sparkæœ€å…¨ç‰ˆçš„pom.xml</strong></p>
<p><a href="https://github.com/apache/spark/blob/master/pom.xml" target="_blank" rel="noopener">https://github.com/apache/spark/blob/master/pom.xml</a></p>
<p><strong>maven repository</strong></p>
<p><a href="https://mvnrepository.com/search?q=spark" target="_blank" rel="noopener">https://mvnrepository.com/search?q=spark</a></p>
<figure class="highlight xml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta"><?xml version="1.0" encoding="UTF-8"?></span></span><br><span class="line"></span><br><span class="line"><span class="tag"><<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"</span>></span></span><br><span class="line"></span><br><span class="line">  <span class="tag"><<span class="name">modelVersion</span>></span>4.0.0<span class="tag"></<span class="name">modelVersion</span>></span></span><br><span class="line">  <span class="tag"><<span class="name">packaging</span>></span>war<span class="tag"></<span class="name">packaging</span>></span></span><br><span class="line"></span><br><span class="line">  <span class="tag"><<span class="name">name</span>></span>TestSpark<span class="tag"></<span class="name">name</span>></span></span><br><span class="line">  <span class="tag"><<span class="name">groupId</span>></span>com.kfk.spark<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">  <span class="tag"><<span class="name">artifactId</span>></span>TestSpark<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">  <span class="tag"><<span class="name">version</span>></span>1.0-SNAPSHOT<span class="tag"></<span class="name">version</span>></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="tag"><<span class="name">properties</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">scala.version</span>></span>2.11.12<span class="tag"></<span class="name">scala.version</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">scala.binary.version</span>></span>2.11<span class="tag"></<span class="name">scala.binary.version</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">spark.version</span>></span>2.2.0<span class="tag"></<span class="name">spark.version</span>></span></span><br><span class="line">  <span class="tag"></<span class="name">properties</span>></span></span><br><span class="line"></span><br><span class="line">  <span class="tag"><<span class="name">dependencies</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">      <span class="tag"><<span class="name">groupId</span>></span>org.apache.spark<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">      <span class="tag"><<span class="name">artifactId</span>></span>spark-core_${scala.binary.version}<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">      <span class="tag"><<span class="name">version</span>></span>${spark.version}<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">      <span class="tag"><<span class="name">groupId</span>></span>org.apache.spark<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">      <span class="tag"><<span class="name">artifactId</span>></span>spark-streaming_${scala.binary.version}<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">      <span class="tag"><<span class="name">version</span>></span>${spark.version}<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">      <span class="tag"><<span class="name">groupId</span>></span>org.apache.spark<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">      <span class="tag"><<span class="name">artifactId</span>></span>spark-sql_${scala.binary.version}<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">      <span class="tag"><<span class="name">version</span>></span>${spark.version}<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">      <span class="tag"><<span class="name">groupId</span>></span>org.apache.spark<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">      <span class="tag"><<span class="name">artifactId</span>></span>spark-hive_${scala.binary.version}<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">      <span class="tag"><<span class="name">version</span>></span>${spark.version}<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">      <span class="tag"><<span class="name">groupId</span>></span>org.apache.spark<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">      <span class="tag"><<span class="name">artifactId</span>></span>spark-streaming-kafka-0-10_${scala.binary.version}<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">      <span class="tag"><<span class="name">version</span>></span>${spark.version}<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line">    <span class="tag"><<span class="name">dependency</span>></span></span><br><span class="line">      <span class="tag"><<span class="name">groupId</span>></span>org.apache.hadoop<span class="tag"></<span class="name">groupId</span>></span></span><br><span class="line">      <span class="tag"><<span class="name">artifactId</span>></span>hadoop-client<span class="tag"></<span class="name">artifactId</span>></span></span><br><span class="line">      <span class="tag"><<span class="name">version</span>></span>2.6.0<span class="tag"></<span class="name">version</span>></span></span><br><span class="line">    <span class="tag"></<span class="name">dependency</span>></span></span><br><span class="line">  <span class="tag"></<span class="name">dependencies</span>></span></span><br><span class="line"></span><br><span class="line"><span class="tag"></<span class="name">project</span>></span></span><br></pre></td></tr></tbody></table></figure>
<h3 id="å¯¼å…¥Scala-SDK"><a href="#å¯¼å…¥Scala-SDK" class="headerlink" title="å¯¼å…¥Scala SDK"></a>å¯¼å…¥<code>Scala SDK</code></h3><p><code>groupId</code>å’Œ<code>artifactId</code>è¢«ç»Ÿç§°ä¸ºâ€œåæ ‡â€æ˜¯ä¸ºäº†ä¿è¯é¡¹ç›®å”¯ä¸€æ€§è€Œæå‡ºçš„</p>
<p><code>groupId</code>ä¸€èˆ¬åˆ†ä¸ºå¤šä¸ªæ®µï¼Œè¿™é‡Œæˆ‘åªè¯´ä¸¤æ®µï¼Œç¬¬ä¸€æ®µä¸ºåŸŸï¼Œç¬¬äºŒæ®µä¸ºå…¬å¸åç§°ã€‚ä¸¾ä¸ªapacheå…¬å¸çš„tomcaté¡¹ç›®ä¾‹å­ï¼šè¿™ä¸ªé¡¹ç›®çš„<code>groupId</code>æ˜¯org.apache</p>
<p>artifactIdè¡¨ç¤ºè¿™ä¸ªé¡¹ç›®çš„åç§°</p>
<p>åŒ…ç»“æ„æœ€å¥½æ˜¯<code>groupId.artifactId.xxx</code></p>
<h2 id="ç¼–å†™sparkç¨‹åº"><a href="#ç¼–å†™sparkç¨‹åº" class="headerlink" title="ç¼–å†™sparkç¨‹åº"></a>ç¼–å†™sparkç¨‹åº</h2><figure class="highlight scala"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.spark.test</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.{<span class="type">SparkConf</span>, <span class="type">SparkContext</span>}</span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">MyScalaWordCout</span> </span>{</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = {</span><br><span class="line">    <span class="comment">//å‚æ•°æ£€æŸ¥</span></span><br><span class="line">    <span class="keyword">if</span> (args.length < <span class="number">2</span>) {</span><br><span class="line">      <span class="type">System</span>.err.println(<span class="string">"Usage: MyWordCout    "</span>)</span><br><span class="line">      <span class="type">System</span>.exit(<span class="number">1</span>)</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">//è·å–å‚æ•°</span></span><br><span class="line">    <span class="keyword">val</span> input=args(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">val</span> output=args(<span class="number">1</span>)</span><br><span class="line">    <span class="comment">//åˆ›å»ºscalaç‰ˆæœ¬çš„SparkContext</span></span><br><span class="line">    <span class="keyword">val</span> conf=<span class="keyword">new</span> <span class="type">SparkConf</span>().setAppName(<span class="string">"myWordCount"</span>)</span><br><span class="line">    <span class="keyword">val</span> sc=<span class="keyword">new</span> <span class="type">SparkContext</span>(conf)</span><br><span class="line">    <span class="comment">//è¯»å–æ•°æ®</span></span><br><span class="line">    <span class="keyword">val</span> lines=sc.textFile(input)</span><br><span class="line">    <span class="comment">//è¿›è¡Œç›¸å…³è®¡ç®—</span></span><br><span class="line">    <span class="keyword">val</span> resultRdd=lines.flatMap(_.split(<span class="string">" "</span>)).map((_,<span class="number">1</span>)).reduceByKey(_+_)</span><br><span class="line">    <span class="comment">//ä¿å­˜ç»“æœ</span></span><br><span class="line">    resultRdd.saveAsTextFile(output)</span><br><span class="line">    sc.stop()</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="æ‰“æˆjaråŒ…ç„¶åä¸Šä¼ åˆ°æœåŠ¡å™¨"><a href="#æ‰“æˆjaråŒ…ç„¶åä¸Šä¼ åˆ°æœåŠ¡å™¨" class="headerlink" title="æ‰“æˆjaråŒ…ç„¶åä¸Šä¼ åˆ°æœåŠ¡å™¨"></a>æ‰“æˆjaråŒ…ç„¶åä¸Šä¼ åˆ°æœåŠ¡å™¨</h2><figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">bin/spark-submit --master <span class="built_in">local</span>[2] /opt/jars/sparkStu.jar hdfs://bigdata-pro01.kfk.com:9000/user/data/stu.txt</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight bash"><table><tbody><tr><td class="code"><pre><span class="line">./bin/spark-submit \</span><br><span class="line">  --class <main-class> \</span><br><span class="line">  --master <master-url> \</span><br><span class="line">  --deploy-mode <deploy-mode> \</span><br><span class="line">  --conf <key>=<value> \</span><br><span class="line">  ... <span class="comment"># other options</span></span><br><span class="line">  <application-jar> \</span><br><span class="line">  [application-arguments]</span><br></pre></td></tr></tbody></table></figure>
<p>Some of the commonly used options are:</p>
<blockquote>
<ul>
<li><code>--class</code>: The entry point for your application (e.g. <code>org.apache.spark.examples.SparkPi</code>)</li>
<li><code>--master</code>: The <a href="https://spark.apache.org/docs/latest/submitting-applications.html#master-urls" target="_blank" rel="noopener">master URL</a> for the cluster (e.g. <code>spark://23.195.26.187:7077</code>)</li>
<li><code>--deploy-mode</code>: Whether to deploy your driver on the worker nodes (<code>cluster</code>) or locally as an external client (<code>client</code>) (default: <code>client</code>) <strong>â€ </strong></li>
<li><code>--conf</code>: Arbitrary Spark configuration property in key=value format. For values that contain spaces wrap â€œkey=valueâ€ in quotes (as shown).</li>
<li><code>application-jar</code>: Path to a bundled jar including your application and all dependencies. The URL must be globally visible inside of your cluster, for instance, an <code>hdfs://</code> path or a <code>file://</code> path that is present on all nodes.</li>
<li><code>application-arguments</code>: Arguments passed to the main method of your main class, if any</li>
</ul>
</blockquote>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>]]></content>
      <tags>
        <tag>å¤§æ•°æ®</tag>
      </tags>
  </entry>
  <entry>
    <title>hello world</title>
    <url>/2019/11/25/first-blog/</url>
    <content><![CDATA[<h2 id="ç¬¬ä¸€ç¯‡åšå®¢"><a href="#ç¬¬ä¸€ç¯‡åšå®¢" class="headerlink" title="ç¬¬ä¸€ç¯‡åšå®¢"></a>ç¬¬ä¸€ç¯‡åšå®¢</h2><p>æ˜¨å¤©èŠ±äº†ä¸€äº›æ—¶é—´æ­å»ºäº† hexo çš„æ¡†æ¶ï¼Œæ‰“ç®—æ…¢æ…¢çš„ä»çŸ¥ä¹è½¬ç§»åˆ°ä¸ªäººåšå®¢äº†ã€‚</p>
<p>ä¸ºä»€ä¹ˆæƒ³è¦å†™åšå®¢å‘¢ï¼Œä¸€æ–¹é¢æ˜¯æƒ³è¦è®°å½•è‡ªå·±çš„æˆé•¿ï¼Œçœ‹ç€è‡ªå·±å­¦ä¼šã€æ€»ç»“çš„ä¸œè¥¿è¶Šæ¥è¶Šå¤šï¼Œè¿˜æ˜¯å¾ˆæœ‰æˆå°±æ„Ÿçš„ï¼›å¦ä¸€æ–¹é¢æ˜¯æƒ³è¦ç•™ä¸‹ç‚¹ä¸œè¥¿ï¼Œå¸®åŠ©åˆ«äººå§ï¼ŒæŠŠè‡ªå·±è¸©è¿‡çš„å‘ï¼Œèµ°è¿‡çš„å¼¯è·¯ä»¥åŠç»éªŒåˆ†äº«ç»™åˆ«äººå§ã€‚</p>
<p>å†™åšå®¢æ˜¯ä¸€ä¸ªæ…¢æ´»ï¼Œå¾—ç²¾é›•ç»†ç¢ï¼Œè¿™å¯¹äºæˆ‘è¿™ä¸ªæ€¥æ€§å­æ˜¯ä¸€ä¸ªæŒºå¤§çš„æŒ‘æˆ˜ã€‚å¸Œæœ›å†™åšå®¢èƒ½å¸®æˆ‘å®¢æœä¸€ä¸‹è¿™ä¸ªæ¯›ç—…å§ã€‚</p>
<p>æœ€åçš„æœ€åå¸Œæœ›ï¼Œæˆ‘èƒ½ä¸€ç›´åšæŒä¸‹å»ï¼Œä¸æ–­çš„è¾“å…¥å’Œä¸æ–­çš„è¾“å‡ºã€‚</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>]]></content>
      <tags>
        <tag>éšç¬”</tag>
      </tags>
  </entry>
</search>
